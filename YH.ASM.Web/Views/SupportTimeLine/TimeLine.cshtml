
@{
    ViewData["Title"] = "售后管理系统";
}
@section Pageheader{

    <script>

        function closeWui() {
            $(".wui-masked").hide();
            $('.wui-ilayout').animate({ width: '0' }, function () {
                $(".wui-ilayout iframe").attr("src", "about:blank");
            });
        }
        function showWui(uri, width) {
            var window_width = width || ($(window).width() / 2);
            $(".wui-masked").show();
            $(".wui-ilayout").show().animate({ width: window_width }, function () {
                var html = $("<div class='wui-ilayout-loading'><i class='icon-spin icon-spinner'></i>正在加载页面...</div>");
                $(".wui-ilayout iframe").before(html);
                $(".wui-ilayout iframe").attr('src', uri);
            });
        }

    </script>


    <h1>
        <small>  工单详情</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Details </li>
    </ol>

}

<section class="content">

    <!-- row -->
    <div class="row" id="tab">
        <div class="col-md-12">
            <!-- The time line -->
            <ul class="timeline">

          


                <li class="time-label">
                    <span class="bg-green">
                        {{supprotInfo.CREATETIME}}
                    </span>
                </li>

                <li>
                    <i class="fa fa-user bg-aqua"></i>

                    <div class="timeline-item">
                        <span class="time"><i class="fa fa-clock-o"></i> {{supprotInfo.CREATETIME}}</span>

                        <h3 class="timeline-header">创建工单</h3>

                        <div class="timeline-body">

                            <form class="form-horizontal" style="margin-top:10px">



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">   创建者：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="supprotInfo.CREATORNAME" readonly="readonly">
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px"> 项目名称：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="supprotInfo.PROJECTNAME" readonly="readonly">
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">问题类型：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="SetType(supprotInfo.TYPE)" readonly="readonly">
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">优先级：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="SetPriority(supprotInfo.PRIORITY)" readonly="readonly">
                                    </div>

                                </div>



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px"> 严重程度：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="SetSeverity(supprotInfo.SEVERITY)" readonly="readonly">
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">发现日期：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" id="txt_finddate" :value="supprotInfo.FINDATE" readonly="readonly" />
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">处理人：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="supprotInfo.CONDUCTORNAME" readonly="readonly">
                                    </div>

                                </div>

                                @*<div class="form-group">
                            <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">创建时间：</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control input-sm" v-model="supprotInfo.CREATETIME" readonly="readonly">
                            </div>

                        </div>*@


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">问题机型：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="supprotInfo.TITLE" placeholder="请填写工单概要" readonly="readonly">
                                    </div>

                                </div>


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">问题描述：</label>
                                    <div class="col-sm-8" style="text-align:left">

                                        <textarea class="form-control" style="margin-left:0px" rows="4" placeholder="请描述详细问题" v-model="supprotInfo.CONTENT" readonly="readonly"></textarea>
                                    </div>
                                </div>



                            </form>






                        </div>
                        <div class="timeline-footer">

                        </div>
                    </div>
                </li>



                <li class="time-label" v-if="disposerShow">
                    <span class="bg-blue">
                        {{disposerInfo.CREATETIME}}
                    </span>
                </li>

                <li v-if="disposerShow">
                    <i class="fa fa-user bg-aqua"></i>

                    <div class="timeline-item">
                        <span class="time"><i class="fa fa-clock-o"></i> {{disposerInfo.CREATETIME}}</span>

                        <h3 class="timeline-header">技术人员处理</h3>

                        <div class="timeline-body">

                            <form class="form-horizontal" style="margin-top:10px">


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">分析人员：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="disposerInfo.ANALYZEUSER" placeholder="请选择分析人员" readonly="readonly">
                                    </div>

                                </div>




                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">责任方：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="disposerInfo.RESPONSIBLE" placeholder="请选择分析人员" readonly="readonly">
                                    </div>

                                </div>

                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">责任人：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="disposerInfo.DUTY" placeholder="请选择分析人员" readonly="readonly">
                                    </div>

                                </div>


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">处理人：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="disposerInfo.NEXT_USER" placeholder="请选择下一处理人员" readonly="readonly">
                                    </div>


                                </div>

                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">工单状态：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="SetStatus(disposerInfo.NEXT_STATUS)" readonly="readonly">

                                    </div>
                                </div>

                                @*<div class="form-group">
                            <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">创建时间：</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control input-sm" :value="disposerInfo.CREATETIME" readonly="readonly">

                            </div>
                        </div>*@


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">初步原因：</label>
                                    <div class="col-sm-8">

                                        <textarea class="form-control" rows="3" placeholder="请填写初步原因分析" v-model="disposerInfo.ANALYZE" readonly="readonly"></textarea>
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">解决方案：</label>
                                    <div class="col-sm-8" style="text-align:left">

                                        <textarea class="form-control" style="margin-left:0px" rows="3" placeholder="请填写建议解决方案" v-model="disposerInfo.SOLUTION" readonly="readonly"></textarea>
                                    </div>

                                </div>



                            </form>





                        </div>
                        <div class="timeline-footer">

                        </div>
                    </div>
                </li>




                <li class="time-label" v-if="pmcShow">
                    <span class="bg-blue">
                        {{pmcInfo.CREATETIME}}
                    </span>
                </li>

                <li v-if="pmcShow">
                    <i class="fa fa-user bg-aqua"></i>

                    <div class="timeline-item">
                        <span class="time"><i class="fa fa-clock-o"></i> {{pmcInfo.CREATETIME}}</span>

                        <h3 class="timeline-header">PMC人员处理</h3>

                        <div class="timeline-body">




                            <form class="form-horizontal" style="margin-top:10px">



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">BOM图纸：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="pmcInfo.BOM" placeholder="请输入BOM图纸" readonly="readonly">
                                    </div>

                                </div>





                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">是否下单：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="pmcInfo.ISBOOK" placeholder="请输入BOM图纸" readonly="readonly">
                                    </div>
                                </div>



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">下单日期：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" id="txt_bookdate" v-model="pmcInfo.BOOKDATE" placeholder="请选择下单日期" readonly="readonly" />
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">下单人：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="pmcInfo.BOOKUSER" placeholder="请输入下单人姓名" readonly="readonly">
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">物料单号：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="pmcInfo.BOOKNO" placeholder="请输入物料单号" readonly="readonly">
                                    </div>

                                </div>


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">交付日期：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" id="txt_delivery" v-model="pmcInfo.DELIVERY" placeholder="请选择交付日期" readonly="readonly" />
                                    </div>

                                </div>


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">发货日期：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" id="txt_senddate" v-model="pmcInfo.SENDDATE" placeholder="请选择发货日期" readonly="readonly" />
                                    </div>

                                </div>

                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">发货单号：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="pmcInfo.SENDNO" placeholder="请填写发货单号" readonly="readonly" />
                                    </div>

                                </div>

                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">收货人：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="pmcInfo.CONSIGNEE" placeholder="请填写收货人" readonly="readonly" />
                                    </div>

                                </div>


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">工单状态：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="SetStatus(pmcInfo.NEXT_STATUS)" readonly="readonly">
                                    </div>
                                </div>



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">处理人：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="pmcInfo.NEXT_USER" placeholder="请选择下一处理人员" readonly="readonly">
                                    </div>


                                </div>


                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">结果描述：</label>
                                    <div class="col-sm-8" style="text-align:left">

                                        <textarea class="form-control" style="margin-left:0px" rows="3" placeholder="" v-model="pmcInfo.REMARKS" readonly="readonly"></textarea>
                                    </div>

                                </div>

                                <!-- /.box-body -->
                                <!-- /.box-footer -->



                            </form>


                        </div>
                        <div class="timeline-footer">

                        </div>
                    </div>
                </li>



                <li class="time-label" v-if="siteShow">
                    <span class="bg-blue">
                        {{siteInfo.CREATETIME}}
                    </span>
                </li>

                <li v-if="siteShow">
                    <i class="fa fa-user bg-aqua"></i>

                    <div class="timeline-item">
                        <span class="time"><i class="fa fa-clock-o"></i> {{siteInfo.CREATETIME}}</span>

                        <h3 class="timeline-header">现场人员处理</h3>

                        <div class="timeline-body">

                            <form class="form-horizontal" style="margin-top:10px">

                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">完成时间：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="siteInfo.ENDDATE" id="txt_enddate" readonly="readonly">
                                    </div>

                                </div>



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">工单状态：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="SetStatus(siteInfo.NEXT_STATUS)" readonly="readonly">
                                    </div>
                                </div>



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">处理人：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="siteInfo.NEXT_USER" placeholder="请选择下一处理人员" readonly="readonly">
                                    </div>


                                </div>

                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">结果描述：</label>
                                    <div class="col-sm-8" style="text-align:left">

                                        <textarea class="form-control" style="margin-left:0px" rows="3" placeholder="" v-model="siteInfo.DESCRIPTION" readonly="readonly" ></textarea>
                                    </div>

                                </div>

                            </form>



                        </div>
                        <div class="timeline-footer">

                        </div>
                    </div>
                </li>



                <li class="time-label" v-if="principalShow">
                    <span class="bg-blue">
                        {{principalInfo.CREATETIME}}
                    </span>
                </li>

                <li v-if="principalShow">
                    <i class="fa fa-user bg-aqua"></i>

                    <div class="timeline-item">
                        <span class="time"><i class="fa fa-clock-o"></i> {{principalInfo.CREATETIME}}</span>

                        <h3 class="timeline-header">负责人审核</h3>

                        <div class="timeline-body">


                            <form class="form-horizontal" style="margin-top:10px">

                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">完成时间：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="principalInfo.ENDDATE" id="txt_enddate" readonly="readonly">
                                    </div>

                                </div>



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">审核人员：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="principalInfo.CHECKUSER" placeholder="请输入审核人员姓名" readonly="readonly">
                                    </div>

                                </div>





                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">工单状态：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" :value="SetStatus(principalInfo.NEXT_STATUS)" readonly="readonly">
                                    </div>
                                </div>



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">处理人：</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control input-sm" v-model="principalInfo.NEXT_USER" placeholder="请选择下一处理人员" readonly="readonly">
                                    </div>


                                </div>



                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-1 control-label" style="padding-right:0px">结果描述：</label>
                                    <div class="col-sm-8" style="text-align:left">

                                        <textarea class="form-control" style="margin-left:0px" rows="3" placeholder="" v-model="principalInfo.RESULT" readonly="readonly"></textarea>
                                    </div>

                                </div>

                                <!-- /.box-body -->
                                <!-- /.box-footer -->




                            </form>

                        </div>
                        <div class="timeline-footer">

                        </div>
                    </div>
                </li>




            </ul>
        </div>
        <!-- /.col -->
    </div>

</section>



@section scripts{
    <script src="~/Reference/scripts/jquery.form.min.js"></script>


    <script src="~/Reference/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
    <script src="~/Reference/bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>


    <script>
        var vm = new Vue({
            el: "#tab",
            data: {
                id: 0,   

                supprotInfo: {},
                supportShow: false,

                disposerInfo: {},
                disposerShow: false,

                pmcInfo: {},
                pmcShow: false,

                siteInfo: {},
                siteShow: false,

                principalInfo: {},
                principalShow: false
            },
            created: function () {

                this.Init();
                this.InitDisposer();
                this.InitPmc();
                this.InitSite();
                this.InitPrincipal();
            },
            mounted: function () {
                var _self = this;
            },
            methods: {

                Init() {
                    var _self = this;
                    _self.id = getQueryString("id");
                    MyAjax({
                        url: "/Support/GetUpdateInfo",
                        type: "POST",
                        data: {
                            id: _self.id
                        },
                        success: function (result) {

                            console.log(JSON.stringify(result));

                            if (!result.Success) {

                                alert_danger(result.Message);
                                return;
                            }
                            _self.supprotInfo = result.Content;

                        }
                    })

                },
                InitDisposer() {
                    var _self = this;
                    _self.id = getQueryString("id");
                    MyAjax({
                        url: "/SupportTimeLine/GetDisposerInfo",
                        type: "POST",
                        data: {
                            id: _self.id
                        },
                        success: function (result) {

                            console.log(JSON.stringify(result));

                            if (!result.Success) {

                                _self.disposerShow = false;
                                return;
                            }

                            _self.disposerInfo = result.Content;
                            _self.disposerShow = true;
                        }
                    })

                },
                InitPmc() {
                    var _self = this;
                    _self.id = getQueryString("id");

                    MyAjax({
                        url: "/SupportTimeLine/GetPmcInfo",
                        type: "POST",
                        data: {
                            id: _self.id
                        },
                        success: function (result) {

                            console.log(JSON.stringify(result));

                            if (!result.Success) {

                                _self.pmcShow = false;
                                return;
                            }

                            _self.pmcInfo = result.Content;
                            _self.pmcShow = true;
                        }
                    })

                },
                InitSite() {
                    var _self = this;
                    _self.id = getQueryString("id");

                    MyAjax({
                        url: "/SupportTimeLine/GetSiteInfo",
                        type: "POST",
                        data: {
                            id: _self.id
                        },
                        success: function (result) {

                            console.log(JSON.stringify(result));

                            if (!result.Success) {

                                _self.siteShow = false;
                                return;
                            }

                            _self.siteInfo = result.Content;
                            _self.siteShow = true;
                        }
                    })

                },
                InitPrincipal() {
                    var _self = this;
                    _self.id = getQueryString("id");

                    MyAjax({
                        url: "/SupportTimeLine/GetPrincipalInfo",
                        type: "POST",
                        data: {
                            id: _self.id
                        },
                        success: function (result) {

                            console.log(JSON.stringify(result));

                            if (!result.Success) {

                                _self.principalShow = false;
                                return;
                            }

                            _self.principalInfo = result.Content;
                            _self.principalShow = true;
                        }
                    })

                },


                SetSeverity: function (value) {
                    return EnumGetSingle(value, Support_Severitylist());
                },
                SetType: function (value) {

                    return EnumGetSingle(value, Support_Typelist());

                },
                SetPriority(value) {
                    return EnumGetSingle(value, Support_Prioritylist());

                },
                SetStatus(value) {

                    return EnumGetSingle(value, Support_Statuslist());
                },
            },



        });

    </script>

}

