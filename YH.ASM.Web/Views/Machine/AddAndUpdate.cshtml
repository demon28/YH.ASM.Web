
@{
    ViewData["Title"] = "售后管理系统";
    Layout = "";
}


<html>
<head>
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="~/Reference/adminLTE/bower_components/bootstrap/dist/css/bootstrap.min.css">


    <!-- Font Awesome -->
    <link rel="stylesheet" href="~/Reference/adminLTE/bower_components/font-awesome/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="~/Reference/adminLTE/bower_components/Ionicons/css/ionicons.min.css">
    <!-- Theme style -->

    <link rel="stylesheet" href="~/Reference/adminLTE/dist/css/AdminLTE.css">

    <link rel="stylesheet" href="~/Reference/bootstrap-datetimepicker/css/bootstrap-datetimepicker.css">

    <link rel="stylesheet" href="~/Reference/adminLTE/dist/css/skins/_all-skins.min.css">




    <script src="~/Reference/scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Reference/vue/vue.min.js"></script>

</head>
<body class="hold-transition skin-blue sidebar-mini" style="background-color:gainsboro">

    <div class="modal-dialog" id="tab_account">
        <div class="modal-content">
            <div class="modal-header">
                @*<button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>*@


                <button type="button" class="btn btn-default pull-right" v-if="type=='添加'" v-on:click="Add()">添 加</button>
                <button type="button" class="btn btn-default pull-right" v-if="type=='修改'" v-on:click="Update()">修 改</button>

                <h4 class="modal-title" id="txt_username">{{type}}</h4>
            </div>
            <div class="modal-body">

                <form class="form-horizontal">



                    <div class="form-group">
                        <label for="inputEmail3" class="col-sm-3 control-label">设备名称：</label>

                        <div class="col-sm-7">

                            <select class="form-control" id="txt_debug_status" v-model="item.TYPES" style="width:320px;">
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="txt_projectname" class="col-sm-3 control-label">型号规格：</label>

                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="txt_projectname" v-model="item.NAME" placeholder="请输入设备名称" style="width:320px;" />
                        </div>
                    </div>


                    <div class="form-group">
                        <label for="txt_address" class="col-sm-3 control-label">设备编号：</label>


                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="txt_productdate" v-model="item.SERIAL" splaceholder="设备序号" style="width:320px;" />
                        </div>
                    </div>
                    <div class="form-group ">
                        <label for="txt_address" class="col-sm-3 control-label">客户名称：</label>

                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="txt_machine" v-model="item.CUSTOMER" placeholder="请输入客户名称" style="width:320px;" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="txt_address" class="col-sm-3 control-label">合同编号：</label>

                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="txt_count" v-model="item.CONTRACT" placeholder="请输入设合同编号" style="width:320px;" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="inputEmail3" class="col-sm-3 control-label">下单时间：</label>

                        <div class="input-group date col-sm-6" style="padding-left:15px">
                            <input type="text" class="form-control" id="txt_order_date" v-model="item.ORDERTIME" style="width:282px;" readonly="readonly" />
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="inputEmail3" class="col-sm-3 control-label">送货时间：</label>

                        <div class="input-group date col-sm-6" style="padding-left:15px">
                            <input type="text" class="form-control" id="txt_install_stardate" v-model="item.DELIVERYTIME" style="width:282px;" readonly="readonly" />
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="txt_address" class="col-sm-3 control-label">送货单号：</label>

                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="txt_count" v-model="item.DELIVERYNUMBER" placeholder="请输入送货单号" style="width:320px;" />
                        </div>
                    </div>


                    <div class="form-group">
                        <label for="inputEmail3" class="col-sm-3 control-label">收货时间：</label>

                        <div class="input-group date col-sm-6" style="padding-left:15px">
                            <input type="text" class="form-control" id="txt_install_enddate" v-model="item.CHECKTIME" style="width:282px;" readonly="readonly" />
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                        </div>

                    </div>


                </form>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default pull-right" v-if="type=='添加'" v-on:click="Add()">添 加</button>
                <button type="button" class="btn btn-default pull-right" v-if="type=='修改'" v-on:click="Update()">修 改</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>

</body>
</html>

<!-- jQuery 3 -->
<!-- Bootstrap 3.3.7 -->
<script src="~/Reference/adminLTE/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

<!-- Slimscroll -->
<script src="~/Reference/adminLTE/bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="~/Reference/adminLTE/bower_components/fastclick/lib/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="~/Reference/adminLTE/dist/js/adminlte.min.js"></script>


<script src="~/Reference/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="~/Reference/bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>


<script src="~/Reference/scripts/jquery.bootstrap-growl.js"></script>


<script src="~/js/jq-paginator.min.js"></script>
<script src="~/Reference/bootbox/bootbox.min.js"></script>
<script src="~/Reference/scripts/CommonScript.js"></script>

<script src="~/Reference/scripts/alertsjavascrtpt.js"></script>

<script>



    var vm = new Vue({
        el: "#tab_account",
        data: {
            type: "add",
            id: 0,      //主键id

            item: {}

        },
        created: function () {

            var ops = getQueryString("type");


            this.LoadTyps();


            if (ops == "add") {
                this.type = "添加";
                return;
            }
            this.type = "修改";

         
            this.Init();
     

        },
        mounted: function () {

            var _self = this;


            $('#txt_install_enddate ,#txt_install_stardate,#txt_order_date').datetimepicker({
                format: 'yyyy-mm-dd ',
                autoclose: true,
                minView: "month",  ///选择日期后，不会再跳转去选择时分秒
                language: 'zh-CN',
                dateFormat: 'yyyy-mm-dd',//日期显示格式
                // timeFormat: 'HH:mm:ss',//时间显示格式
                todayBtn: 1,
                autoclose: 1,
                // minView: 0,  //0表示可以选择小时、分钟   1只可以选择小时
                // minuteStep: 1,//分钟间隔1分钟
            });


            $('#txt_install_enddate').datetimepicker()
                .on('hide', function (ev) {
                    var value = $("#txt_install_enddate").val();
                    _self.item.CHECKTIME = value;

                });

            $('#txt_install_stardate').datetimepicker()
                .on('hide', function (ev) {
                    var value = $("#txt_install_stardate").val();
                    _self.item.DELIVERYTIME = value;

                });

            $('#txt_order_date').datetimepicker()
                .on('hide', function (ev) {
                    var value = $("#txt_order_date").val();
                    _self.item.ORDERTIME = value;

                });

        },
        methods: {

            Init() {

                var _self = this;

                _self.id = getQueryString("id");

                console.log("当前ID=====：" + _self.id);

                MyAjax({
                    url: "/Machine/GetUpdateInfo",
                    type: "POST",
                    data: {
                        id: _self.id
                    },
                    success: function (result) {

                        console.log(JSON.stringify(result));

                        if (!result.Success) {
                            alert_danger(result.Message);
                            return;
                        }

                        _self.item = result.Content;

                    }
                })
            },


            Add: function () {
                var _self = this;


                console.log(JSON.stringify(_self.item));
                MyAjax({
                    url: "/Machine/Add",
                    type: "POST",
                    data: _self.item,
                    success: function (result) {

                        console.log(JSON.stringify(result));

                        if (!result.Success) {
                            alert_danger(result.Message);
                            return;
                        }

                        alert_success(result.Message);

                        window.parent.vm.Init();

                    }
                })

            },
            Update: function (item) {

                var _self = this;

                MyAjax({
                    url: "/Machine/Update",
                    type: "POST",
                    data:_self.item,
                    
                    success: function (result) {

                        console.log(JSON.stringify(result));

                        if (!result.Success) {
                            alert_danger(result.Message);
                            return;
                        }

                        alert_info(result.Message);

                        window.parent.vm.Init();

                    }
                })



            },




            LoadTyps: function () {
                var _self = this;
                MyAjax({
                    url: "/Machine/ListTypes",
                    type: "POST",
                    data: {

                    },
                    success: function (result) {

                        console.log(JSON.stringify(result));

                        if (!result.Success) {
                            alert_danger(result.Message);
                            return;
                        }


                        for (var i = 0; i < result.Content.length; i++) {

                            $("#txt_debug_status").append($("<option value='" + result.Content[i].ID + "' >" + result.Content[i].NAME+"</option>   "));
                        }



                        $("#txt_debug_status").change(function () {

                            _self.item.TYPES = $("#txt_debug_status").val();
                        });


                    }
                })

             

            }


        }




    });





</script>


